import{_ as M}from"./DeKvNKWT.js";import{r as v,b5 as c,aM as L,b4 as y,b2 as f,b9 as l,bd as S,ba as x,bb as h,b3 as t,bf as d,bN as Q,be as U,bv as q,bB as _,bw as Z,b_ as A}from"./DtJsQ1E2.js";import{g as b}from"./Ch1WCYms.js";import{s as G}from"./C4VK08IU.js";import"./6bUBh_yt.js";const H={class:"h-full w-full flex flex-col justify-center bg-gradient-to-b from-green-400/20 border-green-400/30 border text-base-100 rounded-finsc"},J={class:"flex text-center gap-4 px-4 py-2"},K={class:"flex justify-between w-full h-7"},O={class:"overflow-auto flex-1"},W={class:"w-full table-auto text-sm"},X={class:"divide-y divide-base-neutral"},Y={class:"relative py-1 px-4 text-center"},D={class:"relative py-1 px-4 text-center"},ee={class:"text-center px-4 py-2"},te={class:"border-t border-base-neutral w-full"},ne={class:"flex justify-between px-2 font-semibold"},oe={class:"text-green-600"},se={class:"text-red-600"},ue={__name:"CardBullbear",setup(le){const I=v(!1),m=v([]),w=v([]),u=v({}),P=v([]),B=(a,e)=>{const n=a-e,r=n/e*100;return{changed:n.toFixed(2),changedRatio:r.toFixed(1)}},V=(a,e,n)=>{const r=a.reduce((s,i)=>s+i.qtty,0),o=e.reduce((s,i)=>s+i.qtty,0);return r+o+n.matchQtty},$=(a,e,n)=>{console.log(n);const r=[],o=V(a,e,n);return e.reverse().forEach(s=>{const{changed:i,changedRatio:F}=B(s.price,n.basicPrice);r.push({price:s.price,quantity:s.qtty,changed:i,changedRatio:F,percentQuantity:(s.qtty/o*100).toFixed(2)})}),r.push({price:n.matchPrice,quantity:n.matchQtty,changed:n.changed.toFixed(2),changedRatio:n.changedRatio.toFixed(1),percentQuantity:(n.matchQtty/o*100).toFixed(2)}),a.forEach(s=>{const{changed:i,changedRatio:F}=B(s.price,n.basicPrice);r.push({price:s.price,quantity:s.qtty,changed:i,changedRatio:F,percentQuantity:(s.qtty/o*100).toFixed(2)})}),r},R=a=>a.length===0?0:a.reduce((e,n)=>e+n.qtty,0),g=c(()=>R(m.value)+(u.value.buyForeignQtty||0)),p=c(()=>R(w.value)+(u.value.sellForeignQtty||0)),j=c(()=>(g.value/(g.value+p.value)*100).toFixed(1)),z=c(()=>(p.value/(g.value+p.value)*100).toFixed(1)),T=c(()=>u.value.buyForeignQtty||0),N=c(()=>u.value.sellForeignQtty||0),k=c(()=>(T.value/g.value*100).toFixed(1)),C=c(()=>(N.value/p.value*100).toFixed(1)),E=(a,e,n=1e3,r=10)=>{let o=0;const s=G(()=>{const i=a();i!=null?(e(i),clearInterval(s)):o>=r&&(console.log("No data received, stopping."),clearInterval(s)),o++},n)};return L(()=>{E(()=>window._finSI,()=>{var a,e;m.value=((a=window._finTP)==null?void 0:a.bid)||[],w.value=((e=window._finTP)==null?void 0:e.ask)||[],u.value=window._finSI||{},P.value=$(m.value,w.value,u.value),I.value=!0},900,10)}),(a,e)=>{const n=M,r=A;return y(),f("div",H,[l(I)?(y(),f(S,{key:0},[x(r,{mode:"hover",popper:{placement:"top"}},{panel:h(()=>[t("div",J,[t("div",null,[e[0]||(e[0]=t("div",null,"Tổng mua",-1)),t("div",null,d(l(b)(l(g))),1)]),t("div",null,[e[1]||(e[1]=t("div",null,"Tổng bán",-1)),t("div",null,d(l(b)(l(p))),1)])])]),default:h(()=>[t("div",K,[t("div",{class:"bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg text-center py-1",style:Q({width:l(j)+"%"})},[x(n,{src:"/static/svg/bull.svg",class:"h-5 mx-auto",alt:"Bull"})],4),t("div",{class:"bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg text-center py-1",style:Q({width:l(z)+"%"})},[x(n,{src:"/static/svg/bear.svg",class:"h-5 mx-auto",alt:"Bear"})],4)])]),_:1}),t("div",O,[t("table",W,[t("tbody",X,[(y(!0),f(S,null,U(l(P),(o,s)=>(y(),f("tr",{key:s,class:"relative"},[t("td",{class:q(["absolute bottom-0 left-0 h-1 w-full",{"bg-gradient-to-r from-green-400/80":parseInt(o.changed)>=0,"bg-gradient-to-r from-red-400/20":parseInt(o.changed)<0}]),style:Q({"max-width":o.percentQuantity+"%"})},null,6),t("td",Y,d(l(b)(o.price)),1),t("td",D,d(o.quantity),1),t("td",{class:q(["relative py-1 px-4 text-center",parseInt(o.changed)>0?"text-green-600":"text-red-600"])},d(o.changed),3),t("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(o.changedRatio)>=0,"text-red-400":parseInt(o.changedRatio)<0}])},d(o.changedRatio)+"% ",3)]))),128))])])]),x(r,{mode:"hover",popper:{placement:"top"}},{panel:h(()=>[t("div",ee,[e[2]||(e[2]=_(" Nước ngoài mua : Nước ngoài bán ")),t("div",null,d(`${l(b)(l(T))} (${l(k)}%) : ${l(b)(l(N))} (${l(C)}%)`),1),e[3]||(e[3]=t("div",null,"- - - - - -",-1)),e[4]||(e[4]=_(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại ")),e[5]||(e[5]=t("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1))])]),default:h(()=>[t("div",te,[t("div",ne,[t("div",null,[e[6]||(e[6]=_(" Mua ")),t("span",oe,d(l(k))+"%",1)]),t("div",null,[t("span",se,d(l(C))+"%",1),e[7]||(e[7]=_(" Bán "))])])])]),_:1})],64)):Z("",!0)])}}};export{ue as default};
