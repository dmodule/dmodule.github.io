import{_ as L}from"./hqW_7__3.js";import M from"./CR4GGe83.js";import{s as U}from"./CLNgdXxO.js";import{g as v}from"./DhKP8Bzl.js";import{r as m,y as c,f as Z,o as y,c as f,q as s,F as C,b as x,w as h,a as e,t as d,an as Q,D as A,R as q,d as b,S as G}from"./B5KGO6qV.js";import"./D0IGrh07.js";import"./Dgc4RXB8.js";import"./auiRswdB.js";import"./CNa7_oeY.js";import"./BJyML1aj.js";import"./DSLgKJEY.js";import"./BCmiEcw2.js";import"./gMY9QUdj.js";import"./DPfepL_V.js";import"./DVY25RPC.js";import"./CnxvFA1G.js";import"./DgBGg0UR.js";import"./tLBkHUmY.js";import"./gE8gLvCU.js";import"./fXiJV2nD.js";import"./CX6gLNfa.js";import"./B08LnwSc.js";import"./CxIZtCgj.js";import"./CJZb7twN.js";import"./oUkU2yfS.js";import"./C5zbgi19.js";import"./5rgl6gzn.js";import"./RZ6NCv9n.js";import"./CH_TkMvo.js";const H={class:"h-full w-full flex flex-col justify-center bg-gradient-to-b from-green-400/20 border-green-400/30 border text-base-100 rounded-finsc"},J={class:"flex text-center gap-4 px-4 py-2"},K={class:"flex justify-between w-full h-7"},O={class:"overflow-auto flex-1"},W={class:"w-full table-auto text-sm"},X={class:"divide-y divide-base-neutral"},Y={class:"relative py-1 px-4 text-center"},D={class:"relative py-1 px-4 text-center"},tt={class:"text-center px-4 py-2"},et={class:"border-t border-base-neutral w-full"},nt={class:"flex justify-between px-2 font-semibold"},ot={class:"text-green-600"},rt={class:"text-red-600"},Vt={__name:"CardBullbear",setup(st){const I=m(!1),_=m([]),w=m([]),u=m({}),P=m([]),R=(l,t)=>{const n=l-t,a=n/t*100;return{changed:n.toFixed(2),changedRatio:a.toFixed(1)}},V=(l,t,n)=>{const a=l.reduce((r,i)=>r+i.qtty,0),o=t.reduce((r,i)=>r+i.qtty,0);return a+o+n.matchQtty},$=(l,t,n)=>{console.log(n);const a=[],o=V(l,t,n);return t.reverse().forEach(r=>{const{changed:i,changedRatio:F}=R(r.price,n.basicPrice);a.push({price:r.price,quantity:r.qtty,changed:i,changedRatio:F,percentQuantity:(r.qtty/o*100).toFixed(2)})}),a.push({price:n.matchPrice,quantity:n.matchQtty,changed:n.changed.toFixed(2),changedRatio:n.changedRatio.toFixed(1),percentQuantity:(n.matchQtty/o*100).toFixed(2)}),l.forEach(r=>{const{changed:i,changedRatio:F}=R(r.price,n.basicPrice);a.push({price:r.price,quantity:r.qtty,changed:i,changedRatio:F,percentQuantity:(r.qtty/o*100).toFixed(2)})}),a},B=l=>l.length===0?0:l.reduce((t,n)=>t+n.qtty,0),p=c(()=>B(_.value)+(u.value.buyForeignQtty||0)),g=c(()=>B(w.value)+(u.value.sellForeignQtty||0)),j=c(()=>(p.value/(p.value+g.value)*100).toFixed(1)),z=c(()=>(g.value/(p.value+g.value)*100).toFixed(1)),T=c(()=>u.value.buyForeignQtty||0),N=c(()=>u.value.sellForeignQtty||0),S=c(()=>(T.value/p.value*100).toFixed(1)),k=c(()=>(N.value/g.value*100).toFixed(1)),E=(l,t,n=1e3,a=10)=>{let o=0;const r=U(()=>{const i=l();i!=null?(t(i),clearInterval(r)):o>=a&&(console.log("No data received, stopping."),clearInterval(r)),o++},n)};return Z(()=>{E(()=>window._finSI,()=>{var l,t;_.value=((l=window._finTP)==null?void 0:l.bid)||[],w.value=((t=window._finTP)==null?void 0:t.ask)||[],u.value=window._finSI||{},P.value=$(_.value,w.value,u.value),I.value=!0},900,10)}),(l,t)=>{const n=L,a=M;return y(),f("div",H,[s(I)?(y(),f(C,{key:0},[x(a,{mode:"hover",popper:{placement:"top"}},{panel:h(()=>[e("div",J,[e("div",null,[t[0]||(t[0]=e("div",null,"Tổng mua",-1)),e("div",null,d(s(v)(s(p))),1)]),e("div",null,[t[1]||(t[1]=e("div",null,"Tổng bán",-1)),e("div",null,d(s(v)(s(g))),1)])])]),default:h(()=>[e("div",K,[e("div",{class:"bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg text-center py-1",style:Q({width:s(j)+"%"})},[x(n,{src:"/static/svg/bull.svg",class:"h-5 mx-auto",alt:"Bull"})],4),e("div",{class:"bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg text-center py-1",style:Q({width:s(z)+"%"})},[x(n,{src:"/static/svg/bear.svg",class:"h-5 mx-auto",alt:"Bear"})],4)])]),_:1}),e("div",O,[e("table",W,[e("tbody",X,[(y(!0),f(C,null,A(s(P),(o,r)=>(y(),f("tr",{key:r,class:"relative"},[e("td",{class:q(["absolute bottom-0 left-0 h-1 w-full",{"bg-gradient-to-r from-green-400/80":parseInt(o.changed)>=0,"bg-gradient-to-r from-red-400/20":parseInt(o.changed)<0}]),style:Q({"max-width":o.percentQuantity+"%"})},null,6),e("td",Y,d(s(v)(o.price)),1),e("td",D,d(o.quantity),1),e("td",{class:q(["relative py-1 px-4 text-center",parseInt(o.changed)>0?"text-green-600":"text-red-600"])},d(o.changed),3),e("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(o.changedRatio)>=0,"text-red-400":parseInt(o.changedRatio)<0}])},d(o.changedRatio)+"% ",3)]))),128))])])]),x(a,{mode:"hover",popper:{placement:"top"}},{panel:h(()=>[e("div",tt,[t[2]||(t[2]=b(" Nước ngoài mua : Nước ngoài bán ")),e("div",null,d(`${s(v)(s(T))} (${s(S)}%) : ${s(v)(s(N))} (${s(k)}%)`),1),t[3]||(t[3]=e("div",null,"- - - - - -",-1)),t[4]||(t[4]=b(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại ")),t[5]||(t[5]=e("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1))])]),default:h(()=>[e("div",et,[e("div",nt,[e("div",null,[t[6]||(t[6]=b(" Mua ")),e("span",ot,d(s(S))+"%",1)]),e("div",null,[e("span",rt,d(s(k))+"%",1),t[7]||(t[7]=b(" Bán "))])])])]),_:1})],64)):G("",!0)])}}};export{Vt as default};
