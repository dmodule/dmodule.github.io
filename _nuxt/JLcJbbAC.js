import{_ as L}from"./bvNvHhZK.js";import{r as y,b5 as d,aL as M,b4 as f,b2 as x,b9 as o,bd as N,ba as b,bb as h,b3 as t,bf as i,bH as Q,be as Z,bw as q,bC as _,bx as H,bZ as U}from"./C6hTUVlg.js";import{g,s as A}from"./ZfMn_2dn.js";const G={class:"rounded-finsc overflow-hidden h-full w-full text-base bg-base-300 flex flex-col justify-between"},J={class:"flex text-center gap-4 px-4 py-2"},K={class:"flex justify-between w-full h-7"},O={class:"overflow-auto flex-1 px-2 mt-2"},W={class:"w-full table-auto text-sm overflow-hidden rounded-lg bg-white/5"},X={class:"divide-y divide-base-neutral"},Y={class:"relative py-1 px-4 text-center"},D={class:"relative py-1 px-4 text-center"},ee={class:"text-center px-4 py-2"},te={class:"w-full p-1"},ne={class:"flex justify-between px-2 font-semibold"},oe={class:"text-green-600"},se={class:"text-red-600"},de={__name:"BoxStrength",setup(le){const P=y(!1),m=y([]),w=y([]),c=y({}),B=y([]),I=(l,e)=>{const n=l-e,a=n/e*100;return{changed:n.toFixed(2),changedRatio:a.toFixed(1)}},V=(l,e,n)=>{const a=l.reduce((r,u)=>r+u.qtty,0),s=e.reduce((r,u)=>r+u.qtty,0);return a+s+n.matchQtty},$=(l,e,n)=>{console.log(n);const a=[],s=V(l,e,n);return e.reverse().forEach(r=>{const{changed:u,changedRatio:F}=I(r.price,n.basicPrice);a.push({price:r.price,quantity:r.qtty,changed:u,changedRatio:F,percentQuantity:(r.qtty/s*100).toFixed(2)})}),a.push({price:n.matchPrice,quantity:n.matchQtty,changed:n.changed.toFixed(2),changedRatio:n.changedRatio.toFixed(1),percentQuantity:(n.matchQtty/s*100).toFixed(2)}),l.forEach(r=>{const{changed:u,changedRatio:F}=I(r.price,n.basicPrice);a.push({price:r.price,quantity:r.qtty,changed:u,changedRatio:F,percentQuantity:(r.qtty/s*100).toFixed(2)})}),a},R=l=>l.length===0?0:l.reduce((e,n)=>e+n.qtty,0),p=d(()=>R(m.value)+(c.value.buyForeignQtty||0)),v=d(()=>R(w.value)+(c.value.sellForeignQtty||0)),j=d(()=>(p.value/(p.value+v.value)*100).toFixed(1)),z=d(()=>(v.value/(p.value+v.value)*100).toFixed(1)),T=d(()=>c.value.buyForeignQtty||0),S=d(()=>c.value.sellForeignQtty||0),k=d(()=>(T.value/p.value*100).toFixed(1)),C=d(()=>(S.value/v.value*100).toFixed(1)),E=(l,e,n=2e3)=>{A(()=>{const a=l();a!=null&&e(a)},n)};return M(()=>{E(()=>window._finSI,()=>{var l,e;console.log(window._finSI),m.value=((l=window._finTP)==null?void 0:l.bid)||[],w.value=((e=window._finTP)==null?void 0:e.ask)||[],c.value=window._finSI||{},B.value=$(m.value,w.value,c.value),P.value=!0},2e3)}),(l,e)=>{const n=L,a=U;return f(),x("div",G,[o(P)?(f(),x(N,{key:0},[b(a,{mode:"hover",popper:{placement:"left"}},{panel:h(()=>[t("div",J,[t("div",null,[e[0]||(e[0]=t("div",null,"Tổng mua",-1)),t("div",null,i(o(g)(o(p))),1)]),t("div",null,[e[1]||(e[1]=t("div",null,"Tổng bán",-1)),t("div",null,i(o(g)(o(v))),1)])])]),default:h(()=>[t("div",K,[t("div",{class:"bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg text-center py-1",style:Q({width:o(j)+"%"})},[b(n,{src:"/static/svg/bull.svg",class:"h-5 mx-auto",alt:"Bull"})],4),t("div",{class:"bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg text-center py-1",style:Q({width:o(z)+"%"})},[b(n,{src:"/static/svg/bear.svg",class:"h-5 mx-auto",alt:"Bear"})],4)])]),_:1}),t("div",O,[t("table",W,[t("tbody",X,[(f(!0),x(N,null,Z(o(B),(s,r)=>(f(),x("tr",{key:r,class:"relative"},[t("td",{class:q(["absolute bottom-0 left-0 h-full w-full",{"bg-gradient-to-r from-green-400/80":parseInt(s.changed)>=0,"bg-gradient-to-r from-red-400/20":parseInt(s.changed)<0}]),style:Q({"max-width":s.percentQuantity+"%"})},null,6),t("td",Y,i(o(g)(s.price)),1),t("td",D,i(o(g)(s.quantity)),1),t("td",{class:q(["relative py-1 px-4 text-center",parseInt(s.changed)>0?"text-green-600":"text-red-600"])},i(s.changed),3),t("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(s.changedRatio)>=0,"text-red-400":parseInt(s.changedRatio)<0}])},i(s.changedRatio)+"% ",3)]))),128))])])]),b(a,{mode:"hover",popper:{placement:"left"}},{panel:h(()=>[t("div",ee,[e[2]||(e[2]=_(" Nước ngoài mua : Nước ngoài bán ")),t("div",null,i(`${o(g)(o(T))} (${o(k)}%) : ${o(g)(o(S))} (${o(C)}%)`),1),e[3]||(e[3]=t("div",null,"- - - - - -",-1)),e[4]||(e[4]=_(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại ")),e[5]||(e[5]=t("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1))])]),default:h(()=>[t("div",te,[t("div",ne,[t("div",null,[e[6]||(e[6]=_(" Mua ")),t("span",oe,i(o(k))+"%",1)]),t("div",null,[t("span",se,i(o(C))+"%",1),e[7]||(e[7]=_(" Bán "))])])])]),_:1})],64)):H("",!0)])}}};export{de as default};
