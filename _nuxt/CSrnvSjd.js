import{_ as ie}from"./DYgW2iG0.js";import{bL as de,ck as ue,cl as re,bs as y,bq as _,by as u,cm as H,cn as W,br as t,bP as D,bF as me,a_ as I,bB as $,bC as ce,bW as M,bx as l,bD as b,bt as pe,r,b3 as N,bb as be,bA as x,bQ as ve,c1 as O,bE as fe}from"./CJ_CGJpm.js";import{p as U,b as xe,f as z,c as ye}from"./Ul5rOUWU.js";import{h as _e,t as ge,l as X,a as Ve,b as he}from"./ChsSowZC.js";import ke from"./BMCXCw7J.js";import"./CvURW2WX.js";import"./BLVB0qGI.js";import"./DdDBkiWh.js";const Se={directives:{maska:ue},props:{modelValue:{},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"VND"},ext:{type:Boolean,default:!1},extInput:{type:Boolean,default:!1},extPlaceholder:{default:""},step:{type:Number,default:100},min:{type:Number,default:0}},data(){return{options:{preProcess:s=>s.replace(/[$,]/g,""),postProcess:s=>s?new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:s.includes(".")?1:0,maximumFractionDigits:2}).format(s):""},percent:null}},computed:{currency:{get(){return this.modelValue},set(s){this.$emit("update:modelValue",s)}}},watch:{percent(s){this.$emit("update:percent",s)}},methods:{parseMoney:U,decrease(){let s=this.parseMoney(this.currency);s-=this.step,s<=this.min&&(s=this.min),this.$emit("update:modelValue",s)},increase(){let s=this.parseMoney(this.currency);s+=this.step,this.$emit("update:modelValue",s)}}},we={class:"w-full flex items-center justify-between bg-base-200 rounded-full p-1 text-sm"},Ce=["disabled","placeholder"],Ue={class:"flex"},Pe={key:0,class:"flex w-20 items-center bg-base-100 rounded-full px-2"},Be=["disabled","placeholder"],Te={key:0};function ze(s,V,i,P,v,f){const n=me,h=re("maska");return y(),_("div",we,[u(n,{onClick:f.decrease,disabled:i.disabled,size:"xs",icon:"i-ri-subtract-line",color:"white",variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled"]),H(t("input",{"onUpdate:modelValue":V[0]||(V[0]=d=>f.currency=d),class:"flex-1 w-full bg-transparent text-center outline-none",type:"text",disabled:i.disabled,placeholder:i.placeholder},null,8,Ce),[[W,f.currency],[h,v.options]]),t("div",Ue,[u(n,{onClick:f.increase,disabled:i.disabled,size:"xs",icon:"i-ri-add-line",color:"white",variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled"]),i.ext?(y(),_("div",Pe,[H(t("input",{"onUpdate:modelValue":V[1]||(V[1]=d=>v.percent=d),disabled:i.disabled||!i.extInput,class:"flex-1 w-full text-center bg-transparent outline-none",type:"text",placeholder:i.extPlaceholder},null,8,Be),[[W,v.percent]]),i.extInput?(y(),_("span",Te,"%")):D("",!0)])):D("",!0)])])}const Le=de(Se,[["render",ze]]),Ne={class:"flex flex-wrap gap-2"},Ie=["onClick"],Me={__name:"Buttons",props:{modelValue:{},items:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(s,{emit:V}){const i=V,P=s,v=I({get:()=>P.modelValue,set:n=>i("update:modelValue",n)}),f=n=>v.value=n;return(n,h)=>(y(),_("div",Ne,[(y(!0),_($,null,ce(s.items,(d,w)=>(y(),_("button",{key:w,class:M(["w-[52px] rounded-full py-0.5 px-1 bg-base-200 hover:bg-base-primary",[l(v)===d.id?"bg-base-primary":"bg-base-200"]]),onClick:k=>f(d.id)},b(d.name),11,Ie))),128))]))}},je={class:"relative flex flex-col h-full w-full max-w-sm text-sm"},Oe={class:"flex justify-center"},De={class:"p-1 overflow-auto"},$e={class:"p-1 rounded-lg flex-1 overflow-auto space-y-2"},Ae={class:"max-w-full relative"},Fe={class:"ml-2 mb-0.5"},qe={class:"flex gap-2"},Ge={class:"flex-1"},Ee={class:"ml-2 mb-0.5"},Ke={class:"flex-none w-2/5"},Qe=["disabled"],Re={class:"flex justify-between"},Ze={class:"flex justify-between my-1"},He={class:"ml-1 bg-green-400/40 text-green-400 px-1 py-0.5 rounded-md"},We={class:"text-green-400"},Xe={class:"flex justify-between"},Ye={class:"ml-1 bg-red-400/40 text-red-400 px-1 py-0.5 rounded-md"},Je={class:"text-red-400"},et={class:"flex justify-between font-semibold mt-2"},tt={class:"text-left"},lt={class:"text-purple-400 font-normal"},st={class:"text-center"},nt={class:"text-orange-400 font-normal"},ot={class:"text-right"},at={class:"text-sky-400 font-normal"},it={key:0,class:"absolute inset-0 backdrop-blur-[3px] bg-black/10 flex items-center justify-center"},ft={__name:"BoxExchange",props:{symbol:{type:String,default:""},textSize:{type:String,default:"1.1rem"},dataSI:{type:Object,default:()=>({})},dataTP:{type:Object,default:()=>({})}},setup(s){const{emit:V}=ye(),i=s,P=pe(),v=r(!1),f=r(1e8),n=r(null),h=r(null),d=r(null),w=r(null),k=r(null),p=r(1),C=r({id:"limit",label:"Giới hạn"}),Y=r([{id:"condition",label:"Điều kiện"},{id:"limit",label:"Giới hạn"}]),B=r("LO"),J=[{id:"LO",name:"LO"},{id:"MP",name:"MP"},{id:"ATO",name:"ATO"},{id:"ATC",name:"ATC"}],L=r(null),ee=[{id:.25,name:"25%"},{id:.5,name:"50%"},{id:.75,name:"75%"},{id:1,name:"100%"}],S=r({}),te=xe(),le=I(()=>te.tradingHandle),T=I(()=>_e(i.dataSI,i.dataTP)),j=I(()=>{var c;let o=0,e=0,m=0;const g=(c=T.value)==null?void 0:c.list;return g.length===7&&(o=g[0].price,e=g[3].price,m=g[6].price),{tran:o,tc:e,san:m}}),se=async()=>{var e;v.value=!0;let o=null;if(((e=C.value)==null?void 0:e.id)==="condition"){const m=i.dataSI.matchPrice,g=n.value>m?"price >= ":"price <= ";o=await Ve(i.symbol,g,p.value?"NB":"NS",B.value,n.value*1e3,U(d.value))}else o=await he(i.symbol,p.value?"BUY":"SELL",B.value,n.value*1e3,U(d.value));o.status?(V("eRefreshStopOrder"),P.add({title:"Đặt lệnh thành công !"})):P.add({title:"Đặt lệnh thất bại !",color:"red"}),v.value=!1},ne=o=>{w.value=n.value+1*o},oe=o=>{k.value=n.value-1*o},ae=()=>{const o=U(h.value),e=U(n.value)*1e3,m=U(k.value)*1e3;if(!f.value||!e||!o){d.value=null;return}const c=f.value*o/100/(e-m);d.value=Math.round(c/100)*100},A=o=>{p.value=o};return N([n,h,k],()=>{ae()}),N(()=>C.value,o=>{console.log(o)}),N(()=>i.symbol,async()=>{var o,e,m;(o=T.value)!=null&&o.list&&((e=T.value)==null?void 0:e.list.length)===7&&(n.value=(m=T.value)==null?void 0:m.list[3].price)},{immediate:!0}),N(()=>L.value,o=>{var e;d.value=(((e=S.value)==null?void 0:e.qmax)||0)*o}),be(async()=>{S.value=await ge(i.symbol,n.value*1e3)}),(o,e)=>{var q,G,E,K,Q,R,Z;const m=ie,g=fe,c=Le,F=Me;return y(),_("div",je,[t("div",Oe,[u(m,{onClick:e[0]||(e[0]=a=>A(1)),scale:.4,text:"Mua",textSize:s.textSize,class:M(["cursor-pointer",{"text-base-primary":l(p),"text-base-bg-100":!l(p)}])},null,8,["textSize","class"]),u(m,{onClick:e[1]||(e[1]=a=>A(0)),scale:.4,text:"Bán",textSize:s.textSize,class:M(["cursor-pointer",{"text-base-bg-100":l(p),"text-base-secondary":!l(p)}])},null,8,["textSize","class"])]),t("div",De,[t("div",$e,[t("div",Ae,[u(g,{modelValue:l(C),"onUpdate:modelValue":e[2]||(e[2]=a=>x(C)?C.value=a:null),options:l(Y),variant:"none",class:"bg-base-200 rounded-full py-0.5",ui:{base:"mx-auto font-semibold uppercase indent-4"}},null,8,["modelValue","options"])]),((q=l(C))==null?void 0:q.id)==="limit"?(y(),_($,{key:0},[t("div",null,[t("div",Fe,b(l(p)===1?"Giá mua":"Giá bán"),1),u(c,{modelValue:l(n),"onUpdate:modelValue":e[3]||(e[3]=a=>x(n)?n.value=a:null),placeholder:"",step:.1},null,8,["modelValue"]),u(F,{modelValue:l(B),"onUpdate:modelValue":e[4]||(e[4]=a=>x(B)?B.value=a:null),items:J,class:"mt-2"},null,8,["modelValue"])]),t("div",null,[e[13]||(e[13]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),u(c,{modelValue:l(d),"onUpdate:modelValue":e[5]||(e[5]=a=>x(d)?d.value=a:null),placeholder:"cổ phiếu"},null,8,["modelValue"]),u(F,{modelValue:l(L),"onUpdate:modelValue":e[6]||(e[6]=a=>x(L)?L.value=a:null),items:ee,class:"mt-2"},null,8,["modelValue"])])],64)):(y(),_($,{key:1},[t("div",qe,[t("div",Ge,[t("div",Ee,b(l(p)===1?"Giá mua":"Giá bán"),1),u(c,{modelValue:l(n),"onUpdate:modelValue":e[7]||(e[7]=a=>x(n)?n.value=a:null),step:.1},null,8,["modelValue"])]),t("div",Ke,[e[14]||(e[14]=t("div",{class:"ml-2 mb-0.5"},"Rủi ro / Nav",-1)),u(c,{modelValue:l(h),"onUpdate:modelValue":e[8]||(e[8]=a=>x(h)?h.value=a:null),placeholder:"%",step:.1},null,8,["modelValue"])])]),t("div",null,[e[15]||(e[15]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),u(c,{modelValue:l(d),"onUpdate:modelValue":e[9]||(e[9]=a=>x(d)?d.value=a:null),placeholder:"cổ phiếu",ext:"",extPlaceholder:(G=l(S))==null?void 0:G.qmax},null,8,["modelValue","extPlaceholder"])]),t("div",null,[e[16]||(e[16]=t("div",{class:"ml-2 mb-0.5"},"Chốt lãi",-1)),u(c,{modelValue:l(w),"onUpdate:modelValue":e[10]||(e[10]=a=>x(w)?w.value=a:null),disabled:!l(n),ext:"",extInput:"",step:.1,"onUpdate:percent":ne},null,8,["modelValue","disabled"])]),t("div",null,[e[17]||(e[17]=t("div",{class:"ml-2 mb-0.5"},"Cắt lỗ",-1)),u(c,{modelValue:l(k),"onUpdate:modelValue":e[11]||(e[11]=a=>x(k)?k.value=a:null),disabled:!l(n),ext:"",extInput:"",step:.1,"onUpdate:percent":oe},null,8,["modelValue","disabled"])])],64)),t("div",null,[t("button",{disabled:l(v),onClick:se,class:M(["mt-2 rounded-full w-full p-1.5 font-semibold hover:opacity-90",{"bg-base-primary":l(p),"bg-base-secondary":!l(p)}]),style:ve({"font-size":s.textSize})}," Xác nhận ",14,Qe)]),t("div",null,[t("div",null,[t("div",Re,[e[18]||(e[18]=t("b",null,"Nav:",-1)),t("div",null,b(l(z)(l(f)))+"đ",1)]),t("div",Ze,[t("div",null,[e[19]||(e[19]=t("b",null,"Sức mua:",-1)),t("span",He,b(l(z)((E=l(S))==null?void 0:E.qmax)),1)]),t("div",We,b(l(z)((K=l(S))==null?void 0:K.ppse))+"đ",1)]),t("div",Xe,[t("div",null,[e[20]||(e[20]=t("b",null,"Sức bán :",-1)),t("span",Ye,b(l(z)((Q=l(S))==null?void 0:Q.tradeQuantity)),1)]),t("div",Je,b(l(z)(((R=l(S))==null?void 0:R.tradeQuantity)*l(n)*1e3))+"đ ",1)])]),t("div",et,[t("div",tt,[e[21]||(e[21]=O(" Trần ")),t("div",lt,b(l(j).tran),1)]),t("div",st,[e[22]||(e[22]=O(" TC ")),t("div",nt,b(l(j).tc),1)]),t("div",ot,[e[23]||(e[23]=O(" Sàn ")),t("div",at,b(l(j).san),1)])]),t("div",null,[e[24]||(e[24]=t("div",{class:"flex justify-between font-semibold mt-2 mb-0.5"},[t("div",null,"Bước giá"),t("div",null,"Khối lượng")],-1)),u(ke,{mode:"list",list:(Z=l(T))==null?void 0:Z.list},null,8,["list"])])])])]),l(le).status?D("",!0):(y(),_("div",it,[t("button",{class:"rounded-full py-1 px-4 bg-yellow-500 text-black",onClick:e[12]||(e[12]=(...a)=>l(X)&&l(X)(...a))}," Mở kết nối ")]))])}}};export{ft as default};
