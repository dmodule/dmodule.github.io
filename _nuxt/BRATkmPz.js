import{_ as oe}from"./DYgW2iG0.js";import{bL as ae,ck as ie,cl as de,bs as y,bq as _,by as i,cm as R,cn as Q,br as t,bP as A,bF as ue,a_ as L,bB as F,bC as re,bW as M,bx as l,bD as w,bt as me,r as m,b3 as I,bb as ce,bA as x,bQ as pe,c1 as D,bE as ve}from"./CJ_CGJpm.js";import{p as P,b as be,f as $}from"./BLRsUYzB.js";import{h as fe,t as xe,l as W,a as ye,b as _e}from"./BlblDOJL.js";import ge from"./Ch_HZii1.js";import"./B_qkIv1B.js";import"./BLVB0qGI.js";import"./DdDBkiWh.js";const Ve={directives:{maska:ie},props:{modelValue:{},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"VND"},ext:{type:Boolean,default:!1},extInput:{type:Boolean,default:!1},extPlaceholder:{default:""},step:{type:Number,default:100},min:{type:Number,default:0}},data(){return{options:{preProcess:s=>s.replace(/[$,]/g,""),postProcess:s=>s?new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:s.includes(".")?1:0,maximumFractionDigits:2}).format(s):""},percent:null}},computed:{currency:{get(){return this.modelValue},set(s){this.$emit("update:modelValue",s)}}},watch:{percent(s){this.$emit("update:percent",s)}},methods:{parseMoney:P,decrease(){let s=this.parseMoney(this.currency);s-=this.step,s<=this.min&&(s=this.min),this.$emit("update:modelValue",s)},increase(){let s=this.parseMoney(this.currency);s+=this.step,this.$emit("update:modelValue",s)}}},he={class:"w-full flex items-center justify-between bg-base-200 rounded-full p-1 text-sm"},ke=["disabled","placeholder"],we={class:"flex"},Se={key:0,class:"flex w-20 items-center bg-base-100 rounded-full px-2"},Ce=["disabled","placeholder"],Pe={key:0};function Ue(s,k,d,b,g,f){const v=ue,a=de("maska");return y(),_("div",he,[i(v,{onClick:f.decrease,disabled:d.disabled,size:"xs",icon:"i-ri-subtract-line",color:"white",variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled"]),R(t("input",{"onUpdate:modelValue":k[0]||(k[0]=u=>f.currency=u),class:"flex-1 w-full bg-transparent text-center outline-none",type:"text",disabled:d.disabled,placeholder:d.placeholder},null,8,ke),[[Q,f.currency],[a,g.options]]),t("div",we,[i(v,{onClick:f.increase,disabled:d.disabled,size:"xs",icon:"i-ri-add-line",color:"white",variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled"]),d.ext?(y(),_("div",Se,[R(t("input",{"onUpdate:modelValue":k[1]||(k[1]=u=>g.percent=u),disabled:d.disabled||!d.extInput,class:"flex-1 w-full text-center bg-transparent outline-none",type:"text",placeholder:d.extPlaceholder},null,8,Ce),[[Q,g.percent]]),d.extInput?(y(),_("span",Pe,"%")):A("",!0)])):A("",!0)])])}const Te=ae(Ve,[["render",Ue]]),Be={class:"flex flex-wrap gap-2"},ze=["onClick"],Ne={__name:"Buttons",props:{modelValue:{},items:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(s,{emit:k}){const d=k,b=s,g=L({get:()=>b.modelValue,set:v=>d("update:modelValue",v)}),f=v=>g.value=v;return(v,a)=>(y(),_("div",Be,[(y(!0),_(F,null,re(s.items,(u,r)=>(y(),_("button",{key:r,class:M(["w-[52px] rounded-full py-0.5 px-1 bg-base-200 hover:bg-base-primary",[l(g)===u.id?"bg-base-primary":"bg-base-200"]]),onClick:U=>f(u.id)},w(u.name),11,ze))),128))]))}},Ie={class:"relative flex flex-col h-full w-full max-w-sm text-sm"},Le={class:"flex justify-center"},Me={class:"p-1 overflow-auto"},je={class:"p-1 rounded-lg flex-1 overflow-auto space-y-2"},De={class:"max-w-full relative"},$e={class:"flex gap-2"},Ae={class:"flex-1"},Fe={class:"flex-none w-2/5"},Oe=["disabled"],qe={class:"flex justify-between"},Ee={class:"flex justify-between"},Ge={class:"ml-1 bg-orange-400/40 text-orange-400 px-1 py-0.5 rounded-md"},Ke={class:"text-orange-400"},Ze={class:"flex justify-between font-semibold mt-2"},Re={class:"text-left"},Qe={class:"text-purple-400 font-normal"},We={class:"text-center"},Xe={class:"text-orange-400 font-normal"},Ye={class:"text-right"},He={class:"text-sky-400 font-normal"},Je={key:0,class:"absolute inset-0 backdrop-blur-[3px] bg-black/10 flex items-center justify-center"},dt={__name:"BoxExchange",props:{symbol:{type:String,default:""},textSize:{type:String,default:"1.1rem"},dataSI:{type:Object,default:()=>({})},dataTP:{type:Object,default:()=>({})}},emits:["success"],setup(s,{emit:k}){const d=k,b=s,g=me(),f=m(!1),v=m(1e8),a=m(null),u=m(null),r=m(null),U=m(null),S=m(null),V=m(1),C=m({id:"limit",label:"Giới hạn"}),X=m([{id:"condition",label:"Điều kiện"},{id:"limit",label:"Giới hạn"}]),T=m("MP"),Y=[{id:"MP",name:"MP"},{id:"LO",name:"LO"},{id:"ATO",name:"ATO"},{id:"ATC",name:"ATC"}],z=m(null),H=[{id:.25,name:"25%"},{id:.5,name:"50%"},{id:.75,name:"75%"},{id:1,name:"100%"}],N=m({}),J=be(),ee=L(()=>J.auth),B=L(()=>fe(b.dataSI,b.dataTP)),j=L(()=>{var p;let n=0,e=0,c=0;const h=(p=B.value)==null?void 0:p.list;return h.length===7&&(n=h[0].price,e=h[3].price,c=h[6].price),{tran:n,tc:e,san:c}}),te=async()=>{var e;f.value=!0;let n=null;if(((e=C.value)==null?void 0:e.id)==="condition"){const c=b.dataSI.matchPrice,h=a.value>c?"price >= ":"price <= ";n=await ye(b.symbol,h,V.value?"NB":"NS",T.value,a.value*1e3,P(r.value))}else n=await _e(b.symbol,V.value?"BUY":"SELL",T.value,a.value*1e3,P(r.value));n.status?(d("success"),g.add({title:"Đặt lệnh thành công !"})):g.add({title:"Đặt lệnh thất bại !",color:"red"}),f.value=!1},le=n=>{U.value=a.value+1*n},se=n=>{S.value=a.value-1*n},ne=()=>{const n=P(u.value),e=P(a.value)*1e3,c=P(S.value)*1e3;if(!v.value||!e||!n){r.value=null;return}const p=v.value*n/100/(e-c);r.value=Math.round(p/100)*100},O=n=>{V.value=n};return I([a,u,S],()=>{ne()}),I(()=>C.value,n=>{console.log(n)}),I(()=>b.symbol,async()=>{var n,e,c;(n=B.value)!=null&&n.list&&((e=B.value)==null?void 0:e.list.length)===7&&(a.value=(c=B.value)==null?void 0:c.list[3].price)},{immediate:!0}),I(()=>z.value,n=>{var e;r.value=((e=N.value)==null?void 0:e.qmax)||0*n}),ce(async()=>{N.value=await xe(b.symbol,a.value*1e3)}),(n,e)=>{var E,G,K,Z;const c=oe,h=ve,p=Te,q=Ne;return y(),_("div",Ie,[t("div",Le,[i(c,{onClick:e[0]||(e[0]=o=>O(1)),scale:.4,text:"Mua",textSize:s.textSize,class:M(["cursor-pointer",{"text-base-primary":l(V),"text-base-bg-100":!l(V)}])},null,8,["textSize","class"]),i(c,{onClick:e[1]||(e[1]=o=>O(0)),scale:.4,text:"Bán",textSize:s.textSize,class:M(["cursor-pointer",{"text-base-bg-100":l(V),"text-base-secondary":!l(V)}])},null,8,["textSize","class"])]),t("div",Me,[t("div",je,[t("div",De,[i(h,{modelValue:l(C),"onUpdate:modelValue":e[2]||(e[2]=o=>x(C)?C.value=o:null),options:l(X),variant:"none",class:"bg-base-200 rounded-full py-0.5",ui:{base:"mx-auto font-semibold uppercase indent-4"}},null,8,["modelValue","options"])]),((E=l(C))==null?void 0:E.id)==="limit"?(y(),_(F,{key:0},[t("div",null,[e[13]||(e[13]=t("div",{class:"ml-2 mb-0.5"},"Giá vào",-1)),i(p,{modelValue:l(a),"onUpdate:modelValue":e[3]||(e[3]=o=>x(a)?a.value=o:null),placeholder:"",step:.1},null,8,["modelValue"]),i(q,{modelValue:l(T),"onUpdate:modelValue":e[4]||(e[4]=o=>x(T)?T.value=o:null),items:Y,class:"mt-2"},null,8,["modelValue"])]),t("div",null,[e[14]||(e[14]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),i(p,{modelValue:l(r),"onUpdate:modelValue":e[5]||(e[5]=o=>x(r)?r.value=o:null),placeholder:"cổ phiếu"},null,8,["modelValue"]),i(q,{modelValue:l(z),"onUpdate:modelValue":e[6]||(e[6]=o=>x(z)?z.value=o:null),items:H,class:"mt-2"},null,8,["modelValue"])])],64)):(y(),_(F,{key:1},[t("div",$e,[t("div",Ae,[e[15]||(e[15]=t("div",{class:"ml-2 mb-0.5"},"Giá vào",-1)),i(p,{modelValue:l(a),"onUpdate:modelValue":e[7]||(e[7]=o=>x(a)?a.value=o:null),step:.1},null,8,["modelValue"])]),t("div",Fe,[e[16]||(e[16]=t("div",{class:"ml-2 mb-0.5"},"Rủi ro / Nav",-1)),i(p,{modelValue:l(u),"onUpdate:modelValue":e[8]||(e[8]=o=>x(u)?u.value=o:null),placeholder:"%",step:.1},null,8,["modelValue"])])]),t("div",null,[e[17]||(e[17]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),i(p,{modelValue:l(r),"onUpdate:modelValue":e[9]||(e[9]=o=>x(r)?r.value=o:null),placeholder:"cổ phiếu",ext:"",extPlaceholder:(G=l(N))==null?void 0:G.qmax},null,8,["modelValue","extPlaceholder"])]),t("div",null,[e[18]||(e[18]=t("div",{class:"ml-2 mb-0.5"},"Chốt lãi",-1)),i(p,{modelValue:l(U),"onUpdate:modelValue":e[10]||(e[10]=o=>x(U)?U.value=o:null),disabled:!l(a),ext:"",extInput:"",step:.1,"onUpdate:percent":le},null,8,["modelValue","disabled"])]),t("div",null,[e[19]||(e[19]=t("div",{class:"ml-2 mb-0.5"},"Cắt lỗ",-1)),i(p,{modelValue:l(S),"onUpdate:modelValue":e[11]||(e[11]=o=>x(S)?S.value=o:null),disabled:!l(a),ext:"",extInput:"",step:.1,"onUpdate:percent":se},null,8,["modelValue","disabled"])])],64)),t("div",null,[t("button",{disabled:l(f),onClick:te,class:M(["mt-2 rounded-full w-full p-1.5 font-semibold hover:opacity-90",{"bg-base-primary":l(V),"bg-base-secondary":!l(V)}]),style:pe({"font-size":s.textSize})}," Xác nhận ",14,Oe)]),t("div",null,[t("div",null,[t("div",qe,[e[20]||(e[20]=t("b",null,"Nav:",-1)),t("div",null,w(l($)(l(v)))+"đ",1)]),t("div",Ee,[t("div",null,[e[21]||(e[21]=t("b",null,"Sức mua:",-1)),t("span",Ge,w(l($)((K=l(N))==null?void 0:K.qmax)),1)]),t("div",Ke,w(l($)(2e8))+"đ",1)])]),t("div",Ze,[t("div",Re,[e[22]||(e[22]=D(" Trần ")),t("div",Qe,w(l(j).tran),1)]),t("div",We,[e[23]||(e[23]=D(" TC ")),t("div",Xe,w(l(j).tc),1)]),t("div",Ye,[e[24]||(e[24]=D(" Sàn ")),t("div",He,w(l(j).san),1)])]),t("div",null,[e[25]||(e[25]=t("div",{class:"flex justify-between font-semibold mt-2 mb-0.5"},[t("div",null,"Bước giá"),t("div",null,"Khối lượng")],-1)),i(ge,{mode:"list",list:(Z=l(B))==null?void 0:Z.list},null,8,["list"])])])])]),l(ee).trading_token?A("",!0):(y(),_("div",Je,[t("button",{class:"rounded-full py-1 px-2 min-w-48 bg-yellow-500",onClick:e[12]||(e[12]=(...o)=>l(W)&&l(W)(...o))}," Đăng nhập để giao dịch ")]))])}}};export{dt as default};
