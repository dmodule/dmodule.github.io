import{_ as ye}from"./CtkwUNzT.js";import{bL as ge,ck as Ve,cl as ke,bs as k,bq as h,by as m,cm as Z,cn as he,br as t,bW as B,bP as W,bF as _e,a_ as R,bB as X,bC as Se,bx as l,bD as x,bt as Pe,r,b3 as P,bb as we,bA as p,co as ue,bQ as Ne,c1 as H,bE as Ce}from"./B5CNXMPg.js";import{p as N,b as Ue,f as O,d as T,e as F,c as Ie}from"./DufZqOZ-.js";import{h as Me,g as Te,t as Be,l as ie,a as K,b as Le,c as de,d as ze}from"./DJrEdPx_.js";import Oe from"./C8YHKvtg.js";import"./p-mXrVAG.js";import"./BLVB0qGI.js";import"./DdDBkiWh.js";const Fe={directives:{maska:Ve},props:{modelValue:{},percent:{},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:"VND"},ext:{type:Boolean,default:!1},extInput:{type:Boolean,default:!1},extPlaceholder:{default:""},step:{type:Number,default:100},min:{type:Number,default:0},color:{default:"white"},classPercent:{defaultL:""},classCurrency:{default:""}},data(){return{options:{preProcess:o=>o.replace(/[$,]/g,""),postProcess:o=>o?o.endsWith(".")?o:new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:o.includes(".")?1:0,maximumFractionDigits:2}).format(o):""},focusInput:null}},computed:{currency:{get(){return this.modelValue},set(o){this.$emit("update:modelValue",o)}}},methods:{parseMoney:N,decrease(){let o=this.parseMoney(this.currency);o-=this.step,o<=this.min&&(o=this.min),this.$emit("update:modelValue",o)},increase(){let o=this.parseMoney(this.currency);o+=this.step,this.$emit("update:modelValue",o)},onPercentInput(o){this.$emit("update:percent",o.target.value)}}},je={class:"w-full flex items-center justify-between bg-base-200 rounded-full p-1 text-sm"},Ae=["disabled","placeholder"],Re={class:"flex"},De=["value","disabled","placeholder"],qe={key:0};function Ee(o,c,u,L,y,v){const n=_e,w=ke("maska");return k(),h("div",je,[m(n,{onClick:v.decrease,disabled:u.disabled,size:"xs",icon:"i-ri-subtract-line",color:u.color,variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled","color"]),Z(t("input",{"onUpdate:modelValue":c[0]||(c[0]=i=>v.currency=i),onFocus:c[1]||(c[1]=()=>y.focusInput="currency"),class:B(["flex-1 w-full bg-transparent text-center outline-none",[u.classCurrency,u.color==="yellow"?"ph-yellow":""]]),type:"text",disabled:u.disabled,placeholder:u.placeholder},null,42,Ae),[[he,v.currency],[w,y.options]]),t("div",Re,[m(n,{onClick:v.increase,disabled:u.disabled,size:"xs",icon:"i-ri-add-line",color:u.color,variant:"ghost",square:"",ui:{rounded:"rounded-full"}},null,8,["onClick","disabled","color"]),u.ext?(k(),h("div",{key:0,class:B(["flex w-20 items-center bg-base-100 rounded-full px-2",[u.classPercent]])},[t("input",{value:u.percent,onInput:c[2]||(c[2]=(...i)=>v.onPercentInput&&v.onPercentInput(...i)),onFocus:c[3]||(c[3]=()=>y.focusInput="percent"),disabled:u.disabled||!u.extInput,class:"flex-1 w-full text-center bg-transparent outline-none",type:"text",placeholder:u.extPlaceholder},null,40,De),u.extInput?(k(),h("span",qe,"%")):W("",!0)],2)):W("",!0)])])}const Ge=ge(Fe,[["render",Ee]]),Qe={class:"flex flex-wrap gap-2"},He=["onClick"],Ke={__name:"Buttons",props:{modelValue:{},items:{type:Array,default:()=>[]},side:{type:Number,default:1}},emits:["update:modelValue"],setup(o,{emit:c}){const u=c,L=o,y=R({get:()=>L.modelValue,set:n=>u("update:modelValue",n)}),v=n=>y.value=n;return(n,w)=>(k(),h("div",Qe,[(k(!0),h(X,null,Se(o.items,(i,g)=>(k(),h("button",{key:g,class:B(["w-[52px] rounded-full py-0.5 px-1 bg-base-200",[o.side?"hover:bg-base-primary":"hover:bg-base-secondary",l(y)===i.id?o.side?"bg-base-primary":"bg-base-secondary":"bg-base-200"]]),onClick:C=>v(i.id)},x(i.name),11,He))),128))]))}},Ze={class:"relative flex flex-col h-full w-full max-w-sm text-sm"},We={class:"flex justify-center"},Xe={class:"p-1 overflow-auto"},Ye={class:"p-1 rounded-lg flex-1 overflow-auto space-y-2"},Je={class:"max-w-full relative"},$e={class:"ml-2 mb-0.5"},et={class:"flex gap-2"},tt={class:"flex-1"},lt={class:"flex items-center ml-2 mb-0.5"},st={class:"flex-none w-2/5 text-yellow-500"},nt=["disabled"],at={class:"flex justify-between"},ot={class:"flex justify-between my-1"},ut={class:"ml-1 bg-green-400/40 text-green-400 px-1 py-0.5 rounded-md"},it={class:"text-green-400"},dt={class:"flex justify-between"},rt={class:"ml-1 bg-red-400/40 text-red-400 px-1 py-0.5 rounded-md"},ct={class:"text-red-400"},mt={class:"flex justify-between font-semibold mt-2"},pt={class:"text-left"},vt={class:"text-purple-400 font-normal"},ft={class:"text-center"},bt={class:"text-orange-400 font-normal"},xt={class:"text-right"},yt={class:"text-sky-400 font-normal"},gt={key:0,class:"absolute inset-0 backdrop-blur-[3px] bg-black/10 flex items-center justify-center"},Ct={__name:"BoxExchange",props:{symbol:{type:String,default:""},textSize:{type:String,default:"1.1rem"},dataSI:{type:Object,default:()=>({})},dataTP:{type:Object,default:()=>({})}},setup(o){const{emit:c}=Ie(),u=o,L=Pe(),y=r(!1),v=r(null),n=r(null),w=r(null),i=r(null),g=r(null),C=r(null),V=r(null),M=r(null),d=r(1),z=r({id:"limit",label:"Giới hạn"}),re=r([{id:"limit",label:"Giới hạn"},{id:"condition",label:"Điều kiện"}]),U=r("LO"),ce=[{id:"LO",name:"LO"},{id:"MP",name:"MP"},{id:"ATO",name:"ATO"},{id:"ATC",name:"ATC"}],j=r(null),me=[{id:.25,name:"25%"},{id:.5,name:"50%"},{id:.75,name:"75%"},{id:1,name:"100%"}],_=r({}),I=r(!1),pe=Ue(),ve=R(()=>pe.tradingHandle),fe=R(()=>Me(u.dataSI,u.dataTP)),D=R(()=>{const{basicPrice:s,ceilingPrice:e,floorPrice:f}=u.dataSI;let S=O(e??0),b=O(s??0),A=O(f??0);return{tran:S,tc:b,san:A}}),be=async()=>{var e;y.value=!0;let s=null;if(((e=z.value)==null?void 0:e.id)==="condition"){const f=u.dataSI.matchPrice,S=n.value>f?"price >= ":"price <= ";s=await K(u.symbol,S,d.value?"NB":"NS",U.value,n.value*1e3,N(i.value)),c("eRefreshStopOrder")}else s=await Le(u.symbol,d.value?"BUY":"SELL",U.value,n.value*1e3,N(i.value)),c("eRefreshLimitOrder");s.status?(L.add({title:de(s.message)}),g.value&&(await K(u.symbol,"price >= ",d.value?"NS":"NB",U.value,g.value*1e3,N(i.value)),c("eRefreshStopOrder")),V.value&&(await K(u.symbol,"price <= ",d.value?"NS":"NB",U.value,V.value*1e3,N(i.value)),c("eRefreshStopOrder"))):L.add({title:de(s.message),color:"red"}),y.value=!1},xe=()=>{const s=N(w.value),e=N(n.value)*1e3,f=N(V.value)*1e3;if(!v.value||!e||!s||e===f){i.value=null;return}const b=v.value*(s/100)/(e-f);i.value=Math.round(b/100)*100},Y=s=>{d.value=s},J=async()=>{_.value=await ze(u.symbol,n.value*1e3)};P([n,w,V],()=>{xe()}),P(()=>n.value,T(async()=>{await J()},600)),P(()=>u.dataSI,async s=>{I.value&&(n.value=s.matchPrice||null)},{immediate:!0}),P(()=>j.value,s=>{var f,S;const e=d.value?(f=_.value)==null?void 0:f.qmax:(S=_.value)==null?void 0:S.tradeQuantity;i.value=Math.round((e||0)*s/100)*100});let q=!1,E=!1;P(()=>C.value,T(s=>{if(console.log("percent",s),E){E=!1;return}q=!0,g.value=isNaN(Math.round(n.value*(1+s/100)/.05)*.05)?0:Math.round(n.value*(1+s/100)/.05)*.05},600)),P(()=>g.value,T(s=>{if(console.log("Profit",s),q){q=!1;return}E=!0;let e=(s/n.value-1)*100;C.value=isNaN(e)?0:e.toFixed(2)},600));let G=!1,Q=!1;return P(()=>M.value,T(s=>{if(Q){Q=!1;return}G=!0,V.value=isNaN(Math.round(n.value*(1+s/100)/.05)*.05)?0:Math.round(n.value*(1+s/100)/.05)*.05},600)),P(()=>V.value,T(s=>{if(G){G=!1;return}Q=!0;let e=(s/n.value-1)*100;M.value=isNaN(e)?0:e.toFixed(2)},600)),P(()=>n.value,T(s=>{g.value=Math.round(s*(1+C.value/100)/.05)*.05,V.value=Math.round(s*(1+M.value/100)/.05)*.05},600)),we(async()=>{if(!Te().status)return[];await J();const s=await Be();v.value=s==null?void 0:s.netAssetValue}),(s,e)=>{var $,ee,te,le,se,ne,ae,oe;const f=ye,S=Ce,b=Ge,A=Ke;return k(),h("div",Ze,[t("div",We,[m(f,{onClick:e[0]||(e[0]=a=>Y(1)),scale:1,text:"Mua",textSize:o.textSize,class:B(["cursor-pointer",{"text-base-primary":l(d),"text-base-bg-100":!l(d)}])},null,8,["textSize","class"]),m(f,{onClick:e[1]||(e[1]=a=>Y(0)),scale:1,bg:"bg-base-secondary",text:"Bán",textSize:o.textSize,class:B(["cursor-pointer",{"text-base-bg-100":l(d),"text-base-secondary":!l(d)}])},null,8,["textSize","class"])]),t("div",Xe,[t("div",Ye,[t("div",Je,[m(S,{modelValue:l(z),"onUpdate:modelValue":e[2]||(e[2]=a=>p(z)?z.value=a:null),options:l(re),variant:"none",class:"bg-base-200 rounded-full py-0.5",ui:{base:"mx-auto font-semibold uppercase indent-4"}},null,8,["modelValue","options"])]),(($=l(z))==null?void 0:$.id)==="limit"?(k(),h(X,{key:0},[t("div",null,[t("div",$e,[t("span",null,x(l(d)===1?"Giá mua":"Giá bán"),1),Z(t("input",{id:"checkkhop",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>p(I)?I.value=a:null),class:"ml-2 accent-green-500"},null,512),[[ue,l(I)]]),e[17]||(e[17]=t("label",{for:"checkkhop",class:"ml-1"},"Realtime",-1))]),m(b,{modelValue:l(n),"onUpdate:modelValue":e[4]||(e[4]=a=>p(n)?n.value=a:null),placeholder:"",step:.1},null,8,["modelValue"]),m(A,{modelValue:l(U),"onUpdate:modelValue":e[5]||(e[5]=a=>p(U)?U.value=a:null),items:ce,side:l(d),class:"mt-2"},null,8,["modelValue","side"])]),t("div",null,[e[18]||(e[18]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),m(b,{modelValue:l(i),"onUpdate:modelValue":e[6]||(e[6]=a=>p(i)?i.value=a:null),placeholder:"cổ phiếu"},null,8,["modelValue"]),m(A,{modelValue:l(j),"onUpdate:modelValue":e[7]||(e[7]=a=>p(j)?j.value=a:null),items:me,side:l(d),class:"mt-2"},null,8,["modelValue","side"])])],64)):(k(),h(X,{key:1},[t("div",et,[t("div",tt,[t("div",lt,[t("span",null,x(l(d)===1?"Giá mua":"Giá bán"),1),Z(t("input",{id:"checkkhop",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>p(I)?I.value=a:null),class:"ml-2 accent-green-500"},null,512),[[ue,l(I)]]),e[19]||(e[19]=t("label",{for:"checkkhop",class:"ml-1"},"Realtime",-1))]),m(b,{modelValue:l(n),"onUpdate:modelValue":e[9]||(e[9]=a=>p(n)?n.value=a:null),step:.1},null,8,["modelValue"])]),t("div",st,[e[20]||(e[20]=t("div",{class:"ml-2 mb-0.5"},"Rủi ro/NAV (%)",-1)),m(b,{modelValue:l(w),"onUpdate:modelValue":e[10]||(e[10]=a=>p(w)?w.value=a:null),placeholder:"%",step:.1,color:"yellow"},null,8,["modelValue"])])]),t("div",null,[e[21]||(e[21]=t("div",{class:"ml-2 mb-0.5"},"Khối lượng",-1)),m(b,{modelValue:l(i),"onUpdate:modelValue":e[11]||(e[11]=a=>p(i)?i.value=a:null),placeholder:"cổ phiếu",ext:"",extPlaceholder:l(d)?(ee=l(_))==null?void 0:ee.qmax:(te=l(_))==null?void 0:te.tradeQuantity},null,8,["modelValue","extPlaceholder"])]),t("div",null,[e[22]||(e[22]=t("div",{class:"ml-2 mb-0.5"},"Chốt lãi",-1)),m(b,{modelValue:l(g),"onUpdate:modelValue":e[12]||(e[12]=a=>p(g)?g.value=a:null),percent:l(C),"onUpdate:percent":e[13]||(e[13]=a=>p(C)?C.value=a:null),disabled:!l(n),classPercent:"text-green-500",ext:"",extInput:"",step:.1},null,8,["modelValue","percent","disabled"])]),t("div",null,[e[23]||(e[23]=t("div",{class:"ml-2 mb-0.5"},"Cắt lỗ",-1)),m(b,{ref:"stopLossRef",modelValue:l(V),"onUpdate:modelValue":e[14]||(e[14]=a=>p(V)?V.value=a:null),percent:l(M),"onUpdate:percent":e[15]||(e[15]=a=>p(M)?M.value=a:null),disabled:!l(n),classPercent:"text-red-500",ext:"",extInput:"",step:.1},null,8,["modelValue","percent","disabled"])])],64)),t("div",null,[t("button",{disabled:l(y),onClick:be,class:B(["mt-2 rounded-full w-full p-1.5 font-semibold hover:opacity-90",{"bg-base-primary":l(d),"bg-base-secondary":!l(d)}]),style:Ne({"font-size":o.textSize})}," Xác nhận ",14,nt)]),t("div",null,[t("div",null,[t("div",at,[e[24]||(e[24]=t("b",null,"Nav:",-1)),t("div",null,x(l(F)(l(v),0,1))+"đ",1)]),t("div",ot,[t("div",null,[e[25]||(e[25]=t("b",null,"Sức mua:",-1)),t("span",ut,x(l(F)((le=l(_))==null?void 0:le.qmax,0,1)),1)]),t("div",it,x(l(O)(l(F)((se=l(_))==null?void 0:se.ppse,0,1)))+"đ ",1)]),t("div",dt,[t("div",null,[e[26]||(e[26]=t("b",null,"Sức bán :",-1)),t("span",rt,x(l(F)((ne=l(_))==null?void 0:ne.tradeQuantity,0,1)),1)]),t("div",ct,x(l(O)(l(F)(((ae=l(_))==null?void 0:ae.tradeQuantity)*l(n)*1e3,0,0)))+"đ ",1)])]),t("div",mt,[t("div",pt,[e[27]||(e[27]=H(" Trần ")),t("div",vt,x(l(D).tran),1)]),t("div",ft,[e[28]||(e[28]=H(" TC ")),t("div",bt,x(l(D).tc),1)]),t("div",xt,[e[29]||(e[29]=H(" Sàn ")),t("div",yt,x(l(D).san),1)])]),t("div",null,[e[30]||(e[30]=t("div",{class:"flex justify-between font-semibold mt-2 mb-0.5"},[t("div",null,"Bước giá"),t("div",null,"Khối lượng")],-1)),m(Oe,{mode:"list",list:(oe=l(fe))==null?void 0:oe.list},null,8,["list"])])])])]),l(ve).status?W("",!0):(k(),h("div",gt,[t("button",{class:"rounded-full py-1 px-4 bg-yellow-500 text-black",onClick:e[16]||(e[16]=(...a)=>l(ie)&&l(ie)(...a))}," Mở kết nối ")]))])}}};export{Ct as default};
