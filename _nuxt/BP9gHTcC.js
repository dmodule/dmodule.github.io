import{_ as L}from"./CgSpnCAA.js";import{r as p,b4 as c,aL as M,b3 as f,b1 as x,b8 as o,bc as S,b9 as b,ba as h,b2 as t,be as d,bF as Q,bd as Z,bu as q,bA as _,bv as A,bZ as U}from"./BfFq9ARU.js";import{g as y,s as G}from"./DxkKgslY.js";const H={class:"rounded-finsc overflow-hidden h-full w-full text-base bg-base-300 flex flex-col justify-between"},J={class:"flex text-center gap-4 px-4 py-2"},K={class:"flex justify-between w-full h-7"},O={class:"overflow-auto flex-1 px-2 mt-2"},W={class:"w-full table-auto text-sm overflow-hidden rounded-lg bg-white/5"},X={class:"divide-y divide-base-neutral"},Y={class:"relative py-1 px-4 text-center"},D={class:"relative py-1 px-4 text-center"},ee={class:"text-center px-4 py-2"},te={class:"w-full p-1"},ne={class:"flex justify-between px-2 font-semibold"},le={class:"text-green-600"},se={class:"text-red-600"},de={__name:"BoxCasting",setup(oe){const I=p(!1),m=p([]),w=p([]),u=p({}),P=p([]),B=(a,e)=>{const n=a-e,r=n/e*100;return{changed:n.toFixed(2),changedRatio:r.toFixed(1)}},V=(a,e,n)=>{const r=a.reduce((s,i)=>s+i.qtty,0),l=e.reduce((s,i)=>s+i.qtty,0);return r+l+n.matchQtty},$=(a,e,n)=>{console.log(n);const r=[],l=V(a,e,n);return e.reverse().forEach(s=>{const{changed:i,changedRatio:F}=B(s.price,n.basicPrice);r.push({price:s.price,quantity:s.qtty,changed:i,changedRatio:F,percentQuantity:(s.qtty/l*100).toFixed(2)})}),r.push({price:n.matchPrice,quantity:n.matchQtty,changed:n.changed.toFixed(2),changedRatio:n.changedRatio.toFixed(1),percentQuantity:(n.matchQtty/l*100).toFixed(2)}),a.forEach(s=>{const{changed:i,changedRatio:F}=B(s.price,n.basicPrice);r.push({price:s.price,quantity:s.qtty,changed:i,changedRatio:F,percentQuantity:(s.qtty/l*100).toFixed(2)})}),r},R=a=>a.length===0?0:a.reduce((e,n)=>e+n.qtty,0),g=c(()=>R(m.value)+(u.value.buyForeignQtty||0)),v=c(()=>R(w.value)+(u.value.sellForeignQtty||0)),j=c(()=>(g.value/(g.value+v.value)*100).toFixed(1)),z=c(()=>(v.value/(g.value+v.value)*100).toFixed(1)),T=c(()=>u.value.buyForeignQtty||0),N=c(()=>u.value.sellForeignQtty||0),k=c(()=>(T.value/g.value*100).toFixed(1)),C=c(()=>(N.value/v.value*100).toFixed(1)),E=(a,e,n=1e3,r=10)=>{let l=0;const s=G(()=>{const i=a();i!=null?(e(i),clearInterval(s)):l>=r&&(console.log("No data received, stopping."),clearInterval(s)),l++},n)};return M(()=>{E(()=>window._finSI,()=>{var a,e;m.value=((a=window._finTP)==null?void 0:a.bid)||[],w.value=((e=window._finTP)==null?void 0:e.ask)||[],u.value=window._finSI||{},P.value=$(m.value,w.value,u.value),I.value=!0},900,10)}),(a,e)=>{const n=L,r=U;return f(),x("div",H,[o(I)?(f(),x(S,{key:0},[b(r,{mode:"hover",popper:{placement:"left"}},{panel:h(()=>[t("div",J,[t("div",null,[e[0]||(e[0]=t("div",null,"Tổng mua",-1)),t("div",null,d(o(y)(o(g))),1)]),t("div",null,[e[1]||(e[1]=t("div",null,"Tổng bán",-1)),t("div",null,d(o(y)(o(v))),1)])])]),default:h(()=>[t("div",K,[t("div",{class:"bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg text-center py-1",style:Q({width:o(j)+"%"})},[b(n,{src:"/static/svg/bull.svg",class:"h-5 mx-auto",alt:"Bull"})],4),t("div",{class:"bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg text-center py-1",style:Q({width:o(z)+"%"})},[b(n,{src:"/static/svg/bear.svg",class:"h-5 mx-auto",alt:"Bear"})],4)])]),_:1}),t("div",O,[t("table",W,[t("tbody",X,[(f(!0),x(S,null,Z(o(P),(l,s)=>(f(),x("tr",{key:s,class:"relative"},[t("td",{class:q(["absolute bottom-0 left-0 h-full w-full",{"bg-gradient-to-r from-green-400/80":parseInt(l.changed)>=0,"bg-gradient-to-r from-red-400/20":parseInt(l.changed)<0}]),style:Q({"max-width":l.percentQuantity+"%"})},null,6),t("td",Y,d(o(y)(l.price)),1),t("td",D,d(l.quantity),1),t("td",{class:q(["relative py-1 px-4 text-center",parseInt(l.changed)>0?"text-green-600":"text-red-600"])},d(l.changed),3),t("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(l.changedRatio)>=0,"text-red-400":parseInt(l.changedRatio)<0}])},d(l.changedRatio)+"% ",3)]))),128))])])]),b(r,{mode:"hover",popper:{placement:"left"}},{panel:h(()=>[t("div",ee,[e[2]||(e[2]=_(" Nước ngoài mua : Nước ngoài bán ")),t("div",null,d(`${o(y)(o(T))} (${o(k)}%) : ${o(y)(o(N))} (${o(C)}%)`),1),e[3]||(e[3]=t("div",null,"- - - - - -",-1)),e[4]||(e[4]=_(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại ")),e[5]||(e[5]=t("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1))])]),default:h(()=>[t("div",te,[t("div",ne,[t("div",null,[e[6]||(e[6]=_(" Mua ")),t("span",le,d(o(k))+"%",1)]),t("div",null,[t("span",se,d(o(C))+"%",1),e[7]||(e[7]=_(" Bán "))])])])]),_:1})],64)):A("",!0)])}}};export{de as default};
