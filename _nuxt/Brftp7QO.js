import{bL as tt,a_ as H,bs as i,bq as a,br as t,bB as g,bC as P,bW as h,bx as o,bD as n,r as et,bX as st,by as M,bA as ot,cm as F,cv as I,bI as rt,bP as Q,bF as nt}from"./B5CNXMPg.js";import{u as V}from"./-Pa_sf8E.js";import{w as it}from"./DZ0CNGnS.js";import{b as at,e as l,c as lt}from"./DufZqOZ-.js";import{g as ct,e as dt,f as ut,i as pt,l as j,j as mt,b as ht,c as yt,k as bt,m as _t}from"./DJrEdPx_.js";import"./DdDBkiWh.js";import"./D0QZyhSl.js";import"./DxqHYnwt.js";import"./p-mXrVAG.js";import"./BLVB0qGI.js";const xt={class:"text-sm border-b border-base-200"},gt={class:"flex gap-2 px-2 -mb-[1px]"},ft=["disabled","onClick"],kt={__name:"Tabs",props:{modelValue:{default:null},items:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(f,{emit:_}){const L=_,k=f,y=H({get:()=>k.modelValue,set:T=>{L("update:modelValue",T)}});return(T,G)=>(i(),a("div",xt,[t("div",gt,[(i(!0),a(g,null,P(f.items,(c,B)=>(i(),a("button",{key:B,type:"button",class:h(["px-2 py-1 border-b border-transparent",{"border-base-primary text-base-primary":o(y)===c.id}]),disabled:f.disabled,onClick:()=>{y.value=c.id}},n(c.name),11,ft))),128))])]))}},Tt=tt(kt,[["__scopeId","data-v-9f83f820"]]),Ct={class:"relative flex flex-col max-h-full overflow-hidden"},wt={class:"py-3 flex-1 h-full overflow-auto"},Dt={class:"w-full px-1.5 text-sm"},Pt={key:0,class:"min-h-10"},Lt={class:"flex flex-wrap gap-1.5 -mt-1 mb-1"},St={class:"text-xs font-semibold mr-1"},$t={class:"table table-pin-rows text-sm text-center"},Bt=["onClick"],Mt={class:"text-right"},Qt={class:"text-right"},Vt={class:"text-right"},Ht={class:"text-right"},Gt={class:"text-right"},Nt={class:"text-right"},Ot={class:"text-right"},Rt={class:"text-right"},zt={class:"text-right"},Yt={key:1,class:"table table-pin-rows text-sm text-center"},At={key:0,class:"text-base-primary"},Et={key:1,class:"text-base-secondary"},Ft=["onClick"],It={key:2,class:"table table-pin-rows text-sm text-center"},jt={key:0,class:"text-base-primary"},qt={key:1,class:"text-base-secondary"},Kt=["onClick"],Ut=["innerHTML"],Wt={key:0,class:"absolute z-10 inset-0 backdrop-blur-[3px] bg-black/10 flex items-center justify-center"},ie={__name:"BoxCommand",props:["tvChartWrap","show"],async setup(f){let _,L;const k=at(),{emit:y}=lt(),T=H(()=>k.tradingHandle),G=et(1),c=H({get:()=>k.command,set:s=>k.setCommand(s)}),B=[{id:1,name:"Sổ lệnh thường"},{id:2,name:"Sổ lệnh điều kiện"},{id:3,name:"Danh mục"}],p=s=>{const r=mt.find(m=>m.id.toLowerCase()===(s==null?void 0:s.toLowerCase()));return r||{}},q=async(s,r)=>{const m=await ht(s,"SELL","MP",0,r);y("eNoticeDialog",{title:"Thông báo",body:`${yt(m.message)}!
Chi tiết: Sell MP ${l(r,0,1)} ${s}`}),y("eRefreshDeal")},N=async s=>{c.value===2?(await bt(s),y("eRefreshStopOrder")):(await _t(s),y("eRefreshLimitOrder"))},K=s=>{const r=s.split(" ");return`${r[1]} ${l(r[2]/1e3,2,1)}`},O=s=>100*(s.marketPrice/s.costPrice-1),R=s=>s.marketPrice*s.openQuantity-s.costPrice*s.openQuantity,U={costPrice:"Tổng GT Vốn",marketPrice:"Tổng GT Thị Trường",profit:"Tổng Lãi/Lỗ"},W=s=>{let r=0,m=0,x=0;return s.forEach(u=>{if(u.openQuantity&&u.costPrice&&u.marketPrice){const e=u.costPrice*u.openQuantity,d=u.marketPrice*u.openQuantity;r+=e,m+=d,x+=d-e}}),{costPrice:r,marketPrice:m,profit:x}},X=s=>{if(s.lastPrice!==0)return l(s.lastPrice/1e3,2,1)},Z=s=>{const r=p(s);return(r==null?void 0:r.color)===3?0:r==null?void 0:r.color},{data:S,status:J}=([_,L]=it(()=>st("command",()=>ct().status?c.value===2?dt("all"):c.value===3?ut():pt():[],{watch:[T,c,G]})),_=await _,L(),_);return(s,r)=>{var u;const m=Tt,x=nt;return i(),a("div",Ct,[M(m,{class:"sticky top-0",modelValue:o(c),"onUpdate:modelValue":r[0]||(r[0]=e=>ot(c)?c.value=e:null),items:B},null,8,["modelValue"]),F(t("div",wt,[t("div",Dt,[o(J)==="success"?(i(),a("div",Pt,[o(c)===3?(i(),a(g,{key:0},[t("div",Lt,[(i(!0),a(g,null,P(W(o(S)),(e,d)=>(i(),a("div",{class:"bg-base-200 p-2 rounded-lg",key:d},[t("span",St,n(U[d])+":",1),t("span",{class:h([e<0?"text-red-500":"text-green-500"])},n(o(l)(e,0))+" đ ",3)]))),128))]),t("table",$t,[r[2]||(r[2]=t("thead",null,[t("tr",{class:"text-xs bg-base-300 top-[-12px]"},[t("th",{class:"py-1"},"Mã"),t("th",{class:"py-1 text-right"},"T+2"),t("th",{class:"py-1 text-right"},"T+1"),t("th",{class:"py-1 text-right"},"T+0.5"),t("th",{class:"py-1 text-right"},"Được GD"),t("th",{class:"py-1 text-right"},"Tổng"),t("th",{class:"py-1 text-right"},"Giá trị vốn"),t("th",{class:"py-1 text-right"},"Giá trị TT"),t("th",{class:"py-1 text-right"},"Giá vốn"),t("th",{class:"py-1 text-right"},"Giá TT"),t("th",{class:"py-1 text-right"},"Lãi/Lỗ (%)"),t("th",{class:"py-1 text-right pr-0.5"},"Lãi/Lỗ (đ)"),t("th")])],-1)),t("tbody",null,[(i(!0),a(g,null,P(o(S),(e,d)=>(i(),a("tr",{key:d},[t("td",null,[t("div",{class:"text-yellow-500 cursor-pointer",onClick:b=>s.$emit("clickSymbol",e.symbol)},n(e.symbol),9,Bt)]),t("td",Mt,n(o(l)(e.t0ReceivingQuantity,0)||0),1),t("td",Qt,n(o(l)(e.t1ReceivingQuantity,0)||0),1),t("td",Vt,n(o(l)(e.t2ReceivingQuantity,0)||0),1),t("td",Ht,n(o(l)(e.tradeQuantity,0)||0),1),t("td",Gt,n(o(l)(e.openQuantity,0)),1),t("td",Nt,n(o(l)(e.costPrice*e.openQuantity,0))+" đ ",1),t("td",Ot,n(o(l)(e.marketPrice*e.openQuantity,0))+" đ ",1),t("td",Rt,n(o(l)(e.costPrice/1e3,2)),1),t("td",zt,n(o(l)(e.marketPrice/1e3,2)),1),t("td",{class:h(["text-right",O(e)>0?"text-base-primary":"text-base-secondary"])},n(o(l)(O(e),2))+"% ",3),t("td",{class:h(["text-right",R(e)>0?"text-base-primary":"text-base-secondary"])},n(o(l)(R(e),0))+" đ ",3),t("td",null,[M(x,{onClick:b=>q(e.symbol,e.tradeQuantity),icon:"i-ri-close-line",color:"red",variant:"ghost","aria-label":"close",size:"xs",ui:{rounded:"rounded-full"}},null,8,["onClick"])])]))),128))])])],64)):o(c)===2?(i(),a("table",Yt,[r[3]||(r[3]=t("thead",null,[t("tr",{class:"text-xs bg-base-300 top-[-12px]"},[t("th",{class:"py-1"},"Lệnh"),t("th",{class:"py-1 w-20"},"Mã/Tiền mặt"),t("th",{class:"py-1"},"Điều kiện"),t("th",{class:"py-1"},"Giá đặt"),t("th",{class:"py-1"},"Khối lượng"),t("th",{class:"py-1"},"Thời gian đặt"),t("th",{class:"py-1"},"Hết hạn"),t("th",{class:"py-1"},"Trạng thái"),t("th",{class:"py-1"})])],-1)),t("tbody",null,[(i(!0),a(g,null,P((u=o(S))==null?void 0:u.content,(e,d)=>{var b,C,w,D,$,z,Y,A,E;return F((i(),a("tr",{key:d},[t("td",null,[((b=e.targetOrder)==null?void 0:b.side)==="NB"?(i(),a("div",At,"Mua")):(i(),a("div",Et,"Bán"))]),t("td",null,[t("div",{onClick:v=>s.$emit("clickSymbol",e.symbol),class:h(["px-1 py-0.5 text-white rounded-sm cursor-pointer",[((C=e.targetOrder)==null?void 0:C.side)==="NB"?"bg-base-primary":"bg-base-secondary"]])},n(e.symbol),11,Ft)]),t("td",null,n(K(e.condition)),1),t("td",null,n(((w=e.targetOrder)==null?void 0:w.price)===0?"MP":o(l)(((D=e.targetOrder)==null?void 0:D.price)/1e3,2)),1),t("td",null,n(o(l)(($=e.targetOrder)==null?void 0:$.quantity,0)),1),t("td",null,n(("useDate"in s?s.useDate:o(V))(e.createdAt,"DD-MM-YYYY (HH:mm)")),1),t("td",null,n(("useDate"in s?s.useDate:o(V))((z=e.timeInForce)==null?void 0:z.expireTime,"DD-MM-YYYY (HH:mm)")),1),t("td",{class:h(["capitalize",[((Y=p(e.status))==null?void 0:Y.color)===1?"text-base-primary":((A=p(e.status))==null?void 0:A.color)===2?"text-yellow-500":"text-base-secondary"]])},n((E=p(e.status))==null?void 0:E.name),3),t("td",null,[M(x,{onClick:v=>N(e.id),icon:"i-ri-close-line",color:"red",variant:"ghost","aria-label":"close",size:"xs",ui:{rounded:"rounded-full"}},null,8,["onClick"])])])),[[I,e.status!=="CANCELLED"]])}),128))])])):(i(),a("table",It,[r[4]||(r[4]=t("thead",null,[t("tr",{class:"text-xs bg-base-300 top-[-12px]"},[t("th",{class:"py-1"},"Lệnh"),t("th",{class:"py-1 w-20"},"Cổ phiếu"),t("th",{class:"py-1"},"Thời gian"),t("th",{class:"py-1"},"Giá đặt"),t("th",{class:"py-1"},"Giá khớp"),t("th",{class:"py-1"},"Khối lượng"),t("th",{class:"py-1"},"Trạng thái"),t("th",{class:"py-1"})])],-1)),t("tbody",null,[(i(!0),a(g,null,P(o(S),(e,d)=>{var b,C,w,D;return i(),a("tr",{key:d},[t("td",null,[e.side==="NB"?(i(),a("div",jt,"Mua")):(i(),a("div",qt,"Bán"))]),t("td",null,[t("div",{onClick:$=>s.$emit("clickSymbol",e.symbol),class:h(["px-1 py-0.5 text-white rounded-sm cursor-pointer",[e.side==="NB"?"bg-base-primary":"bg-base-secondary"]])},n(e.symbol),11,Kt)]),t("td",null,n(("useDate"in s?s.useDate:o(V))(e.modifiedDate,"HH:mm")),1),t("td",null,n(e.orderType!=="LO"?e.orderType:o(l)(e.price/1e3,2,1)),1),t("td",null,[t("div",{innerHTML:X(e)},null,8,Ut)]),t("td",null,n(o(l)(e.fillQuantity,0)||0)+" / "+n(o(l)(e.quantity,0)),1),t("td",{class:h(["capitalize",[((b=p(e.orderStatus))==null?void 0:b.color)===1||((C=p(e.orderStatus))==null?void 0:C.color)===3?"text-base-primary":((w=p(e.orderStatus))==null?void 0:w.color)===2?"text-yellow-500":"text-base-secondary"]])},n((D=p(e.orderStatus))==null?void 0:D.name),3),t("td",null,[Z(e.orderStatus)?(i(),rt(x,{key:0,onClick:$=>N(e.id),icon:"i-ri-close-line",color:"red",variant:"ghost","aria-label":"close",size:"xs",ui:{rounded:"rounded-full"}},null,8,["onClick"])):Q("",!0)])])}),128))])]))])):Q("",!0)])],512),[[I,f.show]]),o(T).status?Q("",!0):(i(),a("div",Wt,[t("button",{class:"rounded-full py-1 px-4 bg-yellow-500 text-black",onClick:r[1]||(r[1]=(...e)=>o(j)&&o(j)(...e))}," Mở kết nối ")]))])}}};export{ie as default};
