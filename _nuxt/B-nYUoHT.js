import{u as w}from"./CvURW2WX.js";import{D as k}from"./CMYjgM1t.js";import{n as u,o as B}from"./ChsSowZC.js";import{b as x,c as C}from"./Ul5rOUWU.js";import{a_ as m,u as A,r as d,b3 as f,bb as R,bs as D,bq as M}from"./CJ_CGJpm.js";import"./BLVB0qGI.js";import"./DdDBkiWh.js";import"./BFk7B0hC.js";import"./BLzfW2ux.js";const V={__name:"TradingviewStock",setup(T,{expose:p}){const a=x(),{getProfile:_}=w(),{sub:b}=_(),r=b.split("|")[1],s=m(()=>a.symbol),{emit:h}=C(),{$colorMode:v}=A(),n=m(()=>v.value),o=d(null),l=d(null),g=e=>{a.setSymbol(e),tvWidget.value.chart().setSymbol(e)},y=e=>{var i;o.value=new k(u,5e3,{maxResponseLength:1e3,expectedOrder:"latestFirst"});const t=new TradingView.widget({theme:n.value,load_last_chart:!0,autosize:!1,width:"100%",height:"100%",symbol:s.value,interval:"1D",timezone:"Asia/Bangkok",container:e,datafeed:o.value,library_path:"/static/tv/charting_library/",locale:B("lang")||"en",enabled_features:["study_templates"],charts_storage_url:u,client_id:r,user_id:r,auto_save_delay:10,charts_storage_api_version:"1.1",disabled_features:["popup_hints"]});t.onChartReady(()=>{t.activeChart().onSymbolChanged().subscribe(null,S=>{const c=S.ticker;s.value=c,a.setSymbol(c)})}),(i=window.frames[0])==null||i.focus()};return f(s,(e,t)=>{t&&o.value.unsubscribeBars(t)}),f(n,e=>{tvWidget.changeTheme(e)}),R(()=>{h("eSymbol",{symbol:s.value}),y(l.value)}),p({updateSymbol:g}),(e,t)=>(D(),M("div",{ref_key:"finscChartRef",ref:l,class:"trader w-full h-full"},null,512))}};export{V as default};
