import{_ as L}from"./DStE3H8k.js";import M from"./DPkidfXh.js";import{s as H}from"./Ujck2X5v.js";import{m as v}from"./MjTnB_fd.js";import{r as _,C as d,h as U,o as h,c as y,q as a,I as S,b as x,w as f,a as e,t as i,aF as Q,W,d as m,H as Z,s as q}from"./B3xU0BQw.js";const A={class:"h-full flex flex-col justify-center mx-auto bg-gradient-to-b from-green-400/10 border-green-400/20 border text-base-100 rounded-2xl"},G={class:"flex text-center gap-4 px-4 py-2"},J=e("div",null,"Tổng mua",-1),K=e("div",null,"Tổng bán",-1),O={class:"flex justify-between w-full"},X={class:"overflow-auto flex-1"},Y={class:"w-full table-auto text-sm"},D={class:"divide-y divide-base-neutral"},ee={class:"relative py-1 px-4 text-center"},te={class:"relative py-1 px-4 text-center"},ne={class:"text-center px-4 py-2"},oe=e("div",null,"- - - - - -",-1),ae=e("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1),se={class:"border-t border-base-neutral w-full"},le={class:"flex justify-between px-2 font-semibold"},re={class:"text-green-600"},ce={class:"text-red-600"},ie={__name:"BullBear",setup(de){const I=_(!1),b=_([]),w=_([]),u=_({}),P=_([]),B=(s,l)=>{const t=s-l,r=t/l*100;return{changed:t.toFixed(2),changedRatio:r.toFixed(1)}},V=(s,l,t)=>{const r=s.reduce((o,c)=>o+c.qtty,0),n=l.reduce((o,c)=>o+c.qtty,0);return r+n+t.matchQtty},$=(s,l,t)=>{console.log(t);const r=[],n=V(s,l,t);return l.reverse().forEach(o=>{const{changed:c,changedRatio:F}=B(o.price,t.basicPrice);r.push({price:o.price,quantity:o.qtty,changed:c,changedRatio:F,percentQuantity:(o.qtty/n*100).toFixed(2)})}),r.push({price:t.matchPrice,quantity:t.matchQtty,changed:t.changed.toFixed(2),changedRatio:t.changedRatio.toFixed(1),percentQuantity:(t.matchQtty/n*100).toFixed(2)}),s.forEach(o=>{const{changed:c,changedRatio:F}=B(o.price,t.basicPrice);r.push({price:o.price,quantity:o.qtty,changed:c,changedRatio:F,percentQuantity:(o.qtty/n*100).toFixed(2)})}),r},R=s=>s.length===0?0:s.reduce((l,t)=>l+t.qtty,0),g=d(()=>R(b.value)+(u.value.buyForeignQtty||0)),p=d(()=>R(w.value)+(u.value.sellForeignQtty||0)),j=d(()=>(g.value/(g.value+p.value)*100).toFixed(1)),z=d(()=>(p.value/(g.value+p.value)*100).toFixed(1)),T=d(()=>u.value.buyForeignQtty||0),N=d(()=>u.value.sellForeignQtty||0),k=d(()=>(T.value/g.value*100).toFixed(1)),C=d(()=>(N.value/p.value*100).toFixed(1)),E=(s,l,t=1e3,r=10)=>{let n=0;const o=H(()=>{const c=s();c!=null?(l(c),clearInterval(o)):n>=r&&(console.log("No data received, stopping."),clearInterval(o)),n++},t)};return U(()=>{E(()=>window._finSI,()=>{var s,l;b.value=((s=window._finTP)==null?void 0:s.bid)||[],w.value=((l=window._finTP)==null?void 0:l.ask)||[],u.value=window._finSI||{},P.value=$(b.value,w.value,u.value),I.value=!0},1e3,10)}),(s,l)=>{const t=L,r=M;return h(),y("div",A,[a(I)?(h(),y(S,{key:0},[x(r,{mode:"hover",popper:{placement:"left"}},{panel:f(()=>[e("div",G,[e("div",null,[J,e("div",null,i(a(v)(a(g))),1)]),e("div",null,[K,e("div",null,i(a(v)(a(p))),1)])])]),default:f(()=>[e("div",O,[e("div",{class:"text-center bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg",style:Q({width:a(j)+"%"})},[x(t,{src:"/static/svg/bull.png",class:"w-6 h-6 my-1 mx-auto",alt:"Bull"})],4),e("div",{class:"text-center bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg",style:Q({width:a(z)+"%"})},[x(t,{src:"/static/svg/bear.png",class:"w-6 h-6 my-1 mx-auto",alt:"Bear"})],4)])]),_:1}),e("div",X,[e("table",Y,[e("tbody",D,[(h(!0),y(S,null,W(a(P),(n,o)=>(h(),y("tr",{key:o,class:"relative"},[e("div",{class:q(["absolute inset-0 w-full",{"bg-green-400/20":parseInt(n.changed)>=0,"bg-red-400/20":parseInt(n.changed)<0}]),style:Q({"max-width":n.percentQuantity+"%"})},null,6),e("td",ee,i(a(v)(n.price)),1),e("td",te,i(n.quantity),1),e("td",{class:q(["relative py-1 px-4 text-center",parseInt(n.changed)>0?"text-green-600":"text-red-600"])},i(n.changed),3),e("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(n.changedRatio)>=0,"text-red-400":parseInt(n.changedRatio)<0}])},i(n.changedRatio)+"% ",3)]))),128))])])]),x(r,{mode:"hover",popper:{placement:"left"}},{panel:f(()=>[e("div",ne,[m(" Nước ngoài mua : Nước ngoài bán "),e("div",null,i(`${a(v)(a(T))} (${a(k)}%) : ${a(v)(a(N))} (${a(C)}%)`),1),oe,m(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại "),ae])]),default:f(()=>[e("div",se,[e("div",le,[e("div",null,[m(" Mua "),e("span",re,i(a(k))+"%",1)]),e("div",null,[e("span",ce,i(a(C))+"%",1),m(" Bán ")])])])]),_:1})],64)):Z("",!0)])}}},he=ie;export{he as _};
