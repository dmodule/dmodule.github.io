import{_ as L}from"./BTjRrQz8.js";import M from"./C6PdLxNi.js";import{s as G}from"./7-X7YiMw.js";import{m as v}from"./DgQDiXJJ.js";import{r as _,B as d,h as H,o as h,c as y,n as a,H as C,b as F,w as x,a as e,t as i,aF as Q,W as U,d as f,G as W,q}from"./CK5d3MQh.js";const Z={class:"h-full flex flex-col justify-center mx-auto bg-gradient-to-b from-green-400/20 border-green-400/30 border text-base-100 rounded-2xl"},A={class:"flex text-center gap-4 px-4 py-2"},J=e("div",null,"Tổng mua",-1),K=e("div",null,"Tổng bán",-1),O={class:"flex justify-between w-full h-10"},X={class:"flex-none relative",style:{width:"1px"}},Y={class:"absolute -top-1 left-1/2 -translate-x-1/2 w-32 h-10 overflow-hidden"},D={class:"overflow-auto flex-1"},ee={class:"w-full table-auto text-sm"},te={class:"divide-y divide-base-neutral"},ne={class:"relative py-1 px-4 text-center"},oe={class:"relative py-1 px-4 text-center"},ae={class:"text-center px-4 py-2"},se=e("div",null,"- - - - - -",-1),le=e("div",null,"(tính cả thỏa thuận) trên tổng khối lượng khớp.",-1),re={class:"border-t border-base-neutral w-full"},ce={class:"flex justify-between px-2 font-semibold"},ie={class:"text-green-600"},de={class:"text-red-600"},ue={__name:"BullBear",setup(pe){const B=_(!1),m=_([]),b=_([]),u=_({}),I=_([]),P=(s,l)=>{const t=s-l,r=t/l*100;return{changed:t.toFixed(2),changedRatio:r.toFixed(1)}},V=(s,l,t)=>{const r=s.reduce((o,c)=>o+c.qtty,0),n=l.reduce((o,c)=>o+c.qtty,0);return r+n+t.matchQtty},$=(s,l,t)=>{console.log(t);const r=[],n=V(s,l,t);return l.reverse().forEach(o=>{const{changed:c,changedRatio:w}=P(o.price,t.basicPrice);r.push({price:o.price,quantity:o.qtty,changed:c,changedRatio:w,percentQuantity:(o.qtty/n*100).toFixed(2)})}),r.push({price:t.matchPrice,quantity:t.matchQtty,changed:t.changed.toFixed(2),changedRatio:t.changedRatio.toFixed(1),percentQuantity:(t.matchQtty/n*100).toFixed(2)}),s.forEach(o=>{const{changed:c,changedRatio:w}=P(o.price,t.basicPrice);r.push({price:o.price,quantity:o.qtty,changed:c,changedRatio:w,percentQuantity:(o.qtty/n*100).toFixed(2)})}),r},R=s=>s.length===0?0:s.reduce((l,t)=>l+t.qtty,0),p=d(()=>R(m.value)+(u.value.buyForeignQtty||0)),g=d(()=>R(b.value)+(u.value.sellForeignQtty||0)),j=d(()=>(p.value/(p.value+g.value)*100).toFixed(1)),z=d(()=>(g.value/(p.value+g.value)*100).toFixed(1)),T=d(()=>u.value.buyForeignQtty||0),N=d(()=>u.value.sellForeignQtty||0),k=d(()=>(T.value/p.value*100).toFixed(1)),S=d(()=>(N.value/g.value*100).toFixed(1)),E=(s,l,t=1e3,r=10)=>{let n=0;const o=G(()=>{const c=s();c!=null?(l(c),clearInterval(o)):n>=r&&(console.log("No data received, stopping."),clearInterval(o)),n++},t)};return H(()=>{E(()=>window._finSI,()=>{var s,l;m.value=((s=window._finTP)==null?void 0:s.bid)||[],b.value=((l=window._finTP)==null?void 0:l.ask)||[],u.value=window._finSI||{},I.value=$(m.value,b.value,u.value),B.value=!0},900,10)}),(s,l)=>{const t=L,r=M;return h(),y("div",Z,[a(B)?(h(),y(C,{key:0},[F(r,{mode:"hover",popper:{placement:"top"}},{panel:x(()=>[e("div",A,[e("div",null,[J,e("div",null,i(a(v)(a(p))),1)]),e("div",null,[K,e("div",null,i(a(v)(a(g))),1)])])]),default:x(()=>[e("div",O,[e("div",{class:"bg-gradient-to-l from-green-400/80 border-green-400 rounded-tl-lg",style:Q({width:a(j)+"%"})},null,4),e("div",X,[e("div",Y,[F(t,{src:"/static/svg/bull-bear.png",class:"h-10 my-1 mx-auto",alt:"Bull & Bear"})])]),e("div",{class:"bg-gradient-to-r from-red-400/80 border-red-400 rounded-tr-lg",style:Q({width:a(z)+"%"})},null,4)])]),_:1}),e("div",D,[e("table",ee,[e("tbody",te,[(h(!0),y(C,null,U(a(I),(n,o)=>(h(),y("tr",{key:o,class:"relative"},[e("div",{class:q(["absolute bottom-0 left-0 h-1 w-full",{"bg-gradient-to-r from-green-400/80":parseInt(n.changed)>=0,"bg-gradient-to-r from-red-400/20":parseInt(n.changed)<0}]),style:Q({"max-width":n.percentQuantity+"%"})},null,6),e("td",ne,i(a(v)(n.price)),1),e("td",oe,i(n.quantity),1),e("td",{class:q(["relative py-1 px-4 text-center",parseInt(n.changed)>0?"text-green-600":"text-red-600"])},i(n.changed),3),e("td",{class:q(["relative py-1 px-4 text-center",{"text-green-400":parseInt(n.changedRatio)>=0,"text-red-400":parseInt(n.changedRatio)<0}])},i(n.changedRatio)+"% ",3)]))),128))])])]),F(r,{mode:"hover",popper:{placement:"top"}},{panel:x(()=>[e("div",ae,[f(" Nước ngoài mua : Nước ngoài bán "),e("div",null,i(`${a(v)(a(T))} (${a(k)}%) : ${a(v)(a(N))} (${a(S)}%)`),1),se,f(" Phần trăm biểu thị tỷ lệ mua bán của khối ngoại "),le])]),default:x(()=>[e("div",re,[e("div",ce,[e("div",null,[f(" Mua "),e("span",ie,i(a(k))+"%",1)]),e("div",null,[e("span",de,i(a(S))+"%",1),f(" Bán ")])])])]),_:1})],64)):W("",!0)])}}},xe=ue;export{xe as _};
