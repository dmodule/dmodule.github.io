import{a as G}from"./C-6mcIHo.js";const S=G().API_FINSC,K=()=>`${S}/order-service/${l().current_broker}`,l=()=>JSON.parse(localStorage.getItem("auth"))||{},C=()=>({"Content-Type":"application/json",Authorization:"Bearer "+l().token,"trading-token":l().trading_token}),L=t=>({"Cannot place order on aom halted symbol":"Không thể đặt lệnh trong phiên GD thỏa thuận","Ordered successfully":"Gửi lệnh thành công","Trade quantity not enough":"Không đủ cổ phiếu để đặt lệnh","Quantity is invalid":"Khối lượng không hợp lệ","quantity is required":"Khối lượng không được để trống","Cannot place order with that order type on BEGIN OF DAY session":"Không thể đặt loại lệnh này ngoài phiên GD","deal not found":"Bạn không sở hữu cổ phiếu này"})[t]||"Lỗi không xác định",v=async(t,e)=>{const o=`${S}/order-service/${l().current_broker}/accounts/${l().account_no}/ppse?symbol=${t}&price=${e}`,r=await Q(o,C());if(r.status===!0)return r.data},I=async(t,e,o,r,s)=>{const i={symbol:t,side:e,orderType:o,price:r,quantity:s,loanPackageId:1769,accountNo:l().account_no};return await O(`${broker_api()}/orders`,C(),i)};async function O(t,e,o,r=null){try{const s=await fetch(t,{method:"POST",headers:e,body:JSON.stringify(o)});if(!s.ok)throw new Error("Network response was not ok");const i=await s.json();if(r)r(i);else return i}catch(s){if(console.error(s),r)r(null);else return null}}async function Q(t,e,o=null){try{const r=await fetch(t,{method:"GET",headers:e});if(!r.ok)throw new Error("Network response was not ok");const s=await r.json();if(o)o(s);else return s}catch(r){if(console.error(r),o)o(null);else return null}}const R=t=>{t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const o=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(window.location.search);return o===null?"":decodeURIComponent(o[1].replace(/\+/g," "))},j=(t={},e={})=>{var x,F,_,$;const{basicPrice:o=0,matchPrice:r=0,matchQtty:s=0}=t,i=Math.max(s*10,...((x=e==null?void 0:e.bid)==null?void 0:x.map(n=>n.qtty*10))||[],...((F=e==null?void 0:e.ask)==null?void 0:F.map(n=>n.qtty*10))||[]),a=(n,u)=>{const p=i?u*10/i*100:0,A=o?((n-o)/o*100).toFixed(1):"0.0",B=n-o;return{changedRatio:A,percentChange:p.toFixed(1),changed:B.toFixed(2)}},y=((_=e==null?void 0:e.bid)==null?void 0:_.map(n=>({price:n.price,qtty:(n.qtty*10).toLocaleString(),...a(n.price,n.qtty)})))||[],m=(($=e==null?void 0:e.ask)==null?void 0:$.map(n=>({price:n.price,qtty:(n.qtty*10).toLocaleString(),...a(n.price,n.qtty)})))||[],f={price:r,qtty:(s*10).toLocaleString(),...a(r,s)},d=[...y,...m].sort((n,u)=>(u==null?void 0:u.price)-(n==null?void 0:n.price));d.splice(3,0,f);const w=n=>!n||n.length===0?0:n.reduce((u,p)=>u+p.qtty*10,0),h=w(e==null?void 0:e.ask),g=w(e==null?void 0:e.bid),c=h+g,D=c?(h/c*100).toFixed(6):"0.0",N=c?(g/c*100).toFixed(6):"0.0",q=t.buyForeignQtty||0,k=t.sellForeignQtty||0,E=c?(q/c*100).toFixed(1):"0.0",M=c?(k/c*100).toFixed(1):"0.0";return{bids:y,asks:m,matchData:f,list:d,sumBuy:h,sumSell:g,sumBuyPercentage:D,sumSellPercentage:N,buyForeign:q,sellForeign:k,buyForeignPercentage:E,sellForeignPercentage:M}};function J(t,e=!1){if(e){const o=new Date;console.log(`${o.toLocaleTimeString()}.${o.getMilliseconds()}> ${t}`)}}function z(t){return t===void 0?"":typeof t=="string"?t:t.message}export{R as a,S as b,Q as c,K as d,I as e,L as f,z as g,j as h,J as l,O as r,v as t};
